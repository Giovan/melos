:ruby
  @title            = "#{t('pages.home.features.read heading')} #{t(".hero.heading")}"
  @meta_description = t("meta.mobile.description")
  @meta_url          = "#{request.protocol}#{request.host_with_port}#{request.fullpath}"

- @main_nav = false
- @sidebar = false
- rtl_class = is_rtl? ? "rtl" : ""

- content_for :stylesheets do
  = stylesheet_link_tag "bdc_home"

- content_for :javascripts do
  = javascript_include_tag "campaigns/100m/jquery.counter.js"

- content_for :typekit_javascripts do
  = javascript_include_tag '//use.typekit.net/mgk8ovf.js'
  :javascript
    try{Typekit.load();}catch(e){}

- content_for :additional_meta do
  = render '/shared/hreflang'
  - locale_dir = (I18n.locale.to_s.eql?("en") or I18n.locale.to_s.eql?("en-GB")) ? '' : '/' + I18n.locale.to_s
  - canonicalHref = "https://#{request.host_with_port}#{locale_dir}"
  - version_id = Version.default_for(I18n.locale.to_s.eql?('en-GB') ? "en" : I18n.locale)
  %link{rel: "alternate", href: "android-app://com.sirma.mobile.bible.android/youversion/bible?reference=JHN.1&version=#{version_id}"}
  %link{rel: "canonical", href: canonicalHref}
  %meta{name: "url",            content: @meta_url}
  %meta{property: "og:title",       content: @title }
  %meta{property: "og:url",         content: @meta_url }
  %meta{property: "og:description", content: @meta_description }
  %meta{name: "twitter:card",             content: "summary"}
  %meta{name: "twitter:url",              content: "#{request.protocol}#{request.host_with_port}#{request.fullpath}"}
  %meta{name: "twitter:title" ,           content: @title}
  %meta{name: "twitter:description",      content: @meta_description}
  %meta{name: "twitter:image",            content: url_for(image_path(localized_bible_icon(120)))}
  %meta{name: "twitter:site",             content: "@YouVersion"}

= cache "bdc_welcome_#{I18n.locale}", expires_in: YV::Caching.a_short_time do
  %article
    #hero.row{class: rtl_class}
      #hero_content.columns.medium-6.small-12
        %h1= t(".hero.heading")
        .row
          .columns.medium-8
            %p=  t(".hero.description")

        %span
          = link_to(t(".hero.start reading"), bible_path, class: 'solid-button green mobile-full')
          &nbsp;
          = t("or.lower")
          &nbsp;
          = link_to(t(".hero.learn more"),"#scroll-point", id: "scroll-anchor" )
        %form
          %input{type:"checkbox", name:"skip", checked: cookies["setting-skip-home"], id:"setting-skip-home"}
          %label{for:"setting-skip-home",id:"label-setting-skip-home"}
            =t(".hero.skip in future")
      .columns.medium-6.show-for-medium-up
        %img{src:'assets/laptop@2x.jpg'}

    .hero_pics.show-for-medium-up

    .row.pad-row
      .columns.medium-9
        %h1
          %img{src: "#{image_path(localized_bible_icon)}"}
          = t(".word with you")
        .row
          .columns.medium-6.r-border
            %p= t(".download description")
          .columns.medium-6    
            %span.counter#download-counter
              %p#counter &nbsp;
              %p= t(".world installs")
      .columns.medium-3
        %img{src: "#{image_path('bdc_mobile_icons.png')}", class: "app-icons"}
        = link_to(t(".download action"), app_page_path, {class: 'solid-button green full'})

    .gray.pad-row
      .row
        .columns.medium-12.text-center
          %h1= t(".get started")
      .row.pad-row
        .columns.medium-12.text-center
          = link_to(t("registration.with facebook"), auth_connect_path(:facebook, redirect: facebook_sign_up_path), {class: 'solid-button fixed blue'})
          %span.or.pad-all
            = t("or.upper")
          = link_to(t("registration.with email"), sign_up_path, {class: 'solid-button fixed gray'})
      .row.pad-row.text-center
        .columns.medium-3
          %img{src: "#{image_path('read_bible_icon.png')}"}
          %div.white.pad-all.round.text-left
            %h2= t(".features.read heading")
            %p
              %span.narrow= t(".features.read description", versions_path: versions_path).html_safe
        
        .columns.medium-3.pad-row-top
          %img{src: "#{image_path('highlight_bible_icon.png')}"}        
          %div.white.pad-all.round.text-left
            %h2= t(".features.study heading")
            %p
              %span.narrow= t(".features.study description").html_safe

        .columns.medium-3.pad-row-top
          %img{src: "#{image_path('subscribe_bible_icon.png')}"}        
          %div.white.pad-all.round.text-left
            %h2= t(".features.subscribe heading")
            %p
              %span.narrow= t(".features.subscribe description").html_safe

        .columns.medium-3
          %img{src: "#{image_path('take_bible_icon.png')}"}        
          %div.white.pad-all.round.text-left
            %h2= t(".features.download heading")
            %p
              %span.narrow= t(".features.download description").html_safe

-#
  = render '/shared/app_banner'

  - content_for :javascripts do
    :javascript

      function commas(nStr) {
        nStr += '';
        var rgx = /(\d+)(\d{3})/;
        while (rgx.test(nStr)) { nStr = nStr.replace(rgx, '$1' + ',' + '$2');}
        return nStr;
      }


      function installs_data(data) {
        STATS = data;

        var start_count = STATS.start_count;
        var start_date = STATS.start_date;
        var average_per_day = STATS.average_per_day;
        var single_pace = 1/(average_per_day/24/60/60)*1000;
        var today_date = Math.round((new Date()).getTime() / 1000);
        var date_difference_seconds = Math.abs(today_date - start_date);
        var date_difference_days_not_round = (date_difference_seconds / 86400);
        var corrected_total_downloads_not_round = Math.round(start_count + (average_per_day*date_difference_days_not_round));

        $("#counter").counter({
          direction: "up",
          format: "#{t("counter.format").gsub(" ", "&nbsp;")}",
          stop: "9,999,999,999",
          initial: commas(corrected_total_downloads_not_round)
        });

      }

      // Fire off request for download stats jsonp
      $(window).load(function() {

        $.getScript('//commondatastorage.googleapis.com/installs.youversion.com/stats_jsonp.js');

        // Settings for skipping home page
        $("#setting-skip-home").on("click",function(e) {
          var checked = $(this).attr("checked");
          var label = $("#label-setting-skip-home");
          if(checked){
            setCookie("setting-skip-home","true",365);
            label.html("#{t(".hero.now skipped")}");
          }
          else {
            deleteCookie("setting-skip-home");
            label.html("#{t(".hero.skip in future")}");
          }
        });

        $("#scroll-anchor").on("click", function(e) {
          e.preventDefault();
          var pos = $("#scroll-point").offset().top;
          if(app.getPage().MODERN_BROWSER){
            $('html:not(:animated),body:not(:animated)').animate({scrollTop:pos},{easing: 'easeInOutCirc', duration:1000});
          } else {$(window).scrollTop(pos);}

        });


      });