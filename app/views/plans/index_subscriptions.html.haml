- @title = t("plans.title")
- @sidebar = true

- content_for :sidebar do
  .widget
    %header
      %span
        =t("plans.success widget title")
    %ul.widget_menu
      %li
        %p= t("plans.success blurb")
      %li
        = link_to(t("plans.success blog link title"), "http://blog.youversion.com/2011/11/get-ready-for-christmas-with-advent-reading-plans-from-youversion/")
        -#TODO: Get correct blog link

%article
  - if request.path == user_plans_path(current_user)
    %h1= (@user == current_user) ? t("plans.my plans") : t("plans.a users plans", username: @user.username)
    %dl.combo_button.float_right
      %dt
      %dd
        = link_to t("plans.all plans"), plans_path
      %dd.highlighted
        = link_to t("plans.my plans"), user_plans_path(current_user)
  -#else: is a different view
      
  - if !@user.subscriptions.empty?
    %ul.big_list
      - @user.subscriptions.each do |plan|
        %li
          %div
            %h4= link_to(plan.name, plan_path(plan))
            .progress_wrap
              .progress_counter
                =t("plans.current progress html", day: plan.current_day, total_days: plan.total_days).html_safe
              .progress_bar_outer
                .progress_bar{:style => "width:#{plan.progress}%"}
                  &nbsp;
              .progress_bar_cap
                &nbsp;
              .progress_bar_shadow
                .progress_percent_complete{style: "left:#{plan.progress}%"}
                  %b= t("percentage display", number: plan.progress)
                  .small= t("plans.completion status (below percentage)")
    = render "shared/pagination", resource_list: @user.subscriptions
  - else
    %div{class: "none"}= (@user == current_user) ? t("plans.you have no plans") : t("plans.no public plans", username: @user.username)