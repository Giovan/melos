From 53810730daed3db42cbf9c0e5a59160c0118b468 Mon Sep 17 00:00:00 2001
From: Caedmon Judd <caedmon@statebuilt.com>
Date: Fri, 21 Oct 2011 12:58:23 -0500
Subject: [PATCH 09/55] Notes work

---
 app/controllers/notes_controller.rb |   27 +++++++++++++++------------
 app/models/note.rb                  |   12 +++++-------
 app/views/notes/index.html.haml     |   10 +++++-----
 export.txt                          |    1 +
 lib/yv_api.rb                       |    1 +
 5 files changed, 27 insertions(+), 24 deletions(-)
 create mode 100644 export.txt

diff --git a/app/controllers/notes_controller.rb b/app/controllers/notes_controller.rb
index d2981cd..8dbd50c 100644
--- a/app/controllers/notes_controller.rb
+++ b/app/controllers/notes_controller.rb
@@ -1,6 +1,6 @@
 class NotesController < ApplicationController
   
-  def index
+  def index    
     @notes = Note.all(current_user)    
   end
   
@@ -18,17 +18,20 @@ class NotesController < ApplicationController
   
   def create
     @note = Note.new(params)
-    @note.user = current_user 
-
-    if @note.save
-      render action: "show"
-    else
-      flash[:alert] = []
-      @note.errors.each do |error|       
-        flash.now[:alert] << error
-      end
-      render action: "new"
-    end    
+    @note.user = current_user
+    
+    @tester = @note.save
+    #render action: "show"
+    
+    #if @note.save
+    #  render action: "show"
+    #else
+    #  flash[:alert] = []
+    #  @note.errors.each do |error|       
+    #    flash.now[:alert] << error
+    #  end
+    #  render action: "new"
+    #end    
   end
   
   def update
diff --git a/app/models/note.rb b/app/models/note.rb
index 1e8b246..0cd5881 100644
--- a/app/models/note.rb
+++ b/app/models/note.rb
@@ -49,9 +49,7 @@ class Note
       @errors = errors.map { |e| e["error"] }
       return false
     end
-
-    #TODO: Complete return
-
+    response
   end
   
   def all(user)
@@ -60,13 +58,13 @@ class Note
   
   def save
     @token = Digest::MD5.hexdigest "#{user.username}.Yv6-#{user.password}"
-    
+    #@reference = reference.to_osis_hash
+debugger    
     response = YvApi.post('notes/create', attributes(:title, :content, :language_iso, :reference, :version,
         :published, :user_status, :shared_connections, :token, :user)) do |errors|
-      @errors = errors.map { |e| e["error"] }
-#debugger      
+      @errors = errors.map { |e| e["error"] }      
       return false
-    end
+    end    
     response
   end
   
diff --git a/app/views/notes/index.html.haml b/app/views/notes/index.html.haml
index 820a5a4..b30be5c 100644
--- a/app/views/notes/index.html.haml
+++ b/app/views/notes/index.html.haml
@@ -1,8 +1,8 @@
 #note
   %h1= "Show Note"
   - @notes.each do |note|
-  %div{id: "title"}= note.title
-  %div{id: "content"}= note.content
-  %div{id: "version"}= note.version
-  %div{id: "reference"}= note.reference
-  %div{id: "status"}= note.status
\ No newline at end of file
+    %div{id: "title"}= note.title
+    %div{id: "content"}= note.content
+    %div{id: "version"}= note.version
+    %div{id: "reference"}= note.reference
+    %div{id: "status"}= note.status
\ No newline at end of file
diff --git a/export.txt b/export.txt
new file mode 100644
index 0000000..dc4d45b
--- /dev/null
+++ b/export.txt
@@ -0,0 +1 @@
+{"response"=>{"data"=>{"errors"=>{"key"=>"unknown", "error"=>"An error was detected which prevented the loading of this page. If this problem persists, please contact the website administrator."}, "stack_trace"=>"/var/www/releases/20111020205231/modules/youversion_api/helpers/MY_valid.php [613]:trim( Array     (         [book] =&gt; gen         [chapter] =&gt; 1         [version] =&gt; 1-10     )      )     /var/www/releases/20111020205231/modules/youversion_api/models/notes_2_1.php [1947]:valid::valid_create_multi_reference( Validation Object     (         [http_code:protected] =&gt; 400         [empty_rules:protected] =&gt; Array             (                 [0] =&gt; required                 [1] =&gt; matches                 [2] =&gt; xor_isset                 [3] =&gt; or_isset                 [4] =&gt; and_isset             )              [pre_filters:protected] =&gt; Array             (                 [*] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [1] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [2] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; string_number_to_float_or_int                             )                          )                  )              [post_filters:protected] =&gt; Array             (             )              [rules:protected] =&gt; Array             (                 [auth_user_id] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                              [1] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; numeric                                     )                                      [1] =&gt;                              )                              [2] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; positive                                     )                                      [1] =&gt;                              )                          )                      [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                          )                  )              [callbacks:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_content                             )                          )                      [reference] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [version] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [user_status] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_user_status                             )                          )                      [highlight_color] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; valid_color                             )                          )                  )              [errors:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; invalid_xml_definition                         [1] =&gt; document invalid                     )                  )              [messages:protected] =&gt; Array             (             )              [array_fields:protected] =&gt; Array             (             )              [submitted:protected] =&gt; 1         [storage:ArrayObject:private] =&gt; Array             (                 [auth_user_id] =&gt; 4163177                 [title] =&gt; rfesfer                 [content] =&gt; fesfewr                 [language_iso] =&gt;                  [reference] =&gt; Array                     (                         [book] =&gt; gen                         [chapter] =&gt; 1                         [version] =&gt; 1-10                     )                      [version] =&gt; aa                 [created] =&gt;                  [published] =&gt;                  [user_status] =&gt; draft                 [share_connections] =&gt;                  [highlight_color] =&gt;                  [rich_content] =&gt;              )          )     , reference, reference )     Notes_2_1_Model->valid_reference_and_version( Validation Object     (         [http_code:protected] =&gt; 400         [empty_rules:protected] =&gt; Array             (                 [0] =&gt; required                 [1] =&gt; matches                 [2] =&gt; xor_isset                 [3] =&gt; or_isset                 [4] =&gt; and_isset             )              [pre_filters:protected] =&gt; Array             (                 [*] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [1] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [2] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; string_number_to_float_or_int                             )                          )                  )              [post_filters:protected] =&gt; Array             (             )              [rules:protected] =&gt; Array             (                 [auth_user_id] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                              [1] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; numeric                                     )                                      [1] =&gt;                              )                              [2] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; positive                                     )                                      [1] =&gt;                              )                          )                      [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                          )                  )              [callbacks:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_content                             )                          )                      [reference] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [version] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [user_status] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_user_status                             )                          )                      [highlight_color] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; valid_color                             )                          )                  )              [errors:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; invalid_xml_definition                         [1] =&gt; document invalid                     )                  )              [messages:protected] =&gt; Array             (             )              [array_fields:protected] =&gt; Array             (             )              [submitted:protected] =&gt; 1         [storage:ArrayObject:private] =&gt; Array             (                 [auth_user_id] =&gt; 4163177                 [title] =&gt; rfesfer                 [content] =&gt; fesfewr                 [language_iso] =&gt;                  [reference] =&gt; Array                     (                         [book] =&gt; gen                         [chapter] =&gt; 1                         [version] =&gt; 1-10                     )                      [version] =&gt; aa                 [created] =&gt;                  [published] =&gt;                  [user_status] =&gt; draft                 [share_connections] =&gt;                  [highlight_color] =&gt;                  [rich_content] =&gt;              )          )     , reference, reference )     /var/www/releases/20111020205231/modules/youversion_api/libraries/MY_Validation.php [432]:call_user_func( Array     (         [0] =&gt; Notes_2_3_Model Object             (                 [errors:protected] =&gt; Array                     (                     )                      [db] =&gt; Postgres_Lite Object                     (                         [config:protected] =&gt; Array                             (                                 [benchmark] =&gt; 1                                 [persistent] =&gt;                                  [connection] =&gt; Array                                     (                                         [type] =&gt; pgsql                                         [user] =&gt; dev                                         [pass] =&gt;                                          [host] =&gt; 127.0.0.1                                         [port] =&gt; 5432                                         [socket] =&gt;                                          [database] =&gt; youversiondev                                     )                                      [character_set] =&gt; utf8                                 [table_prefix] =&gt;                                  [object] =&gt;                                  [escape] =&gt; 1                             )                              [link:protected] =&gt; Resource id #4                         [set:protected] =&gt; Array                             (                             )                              [where:protected] =&gt; Array                             (                             )                              [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                          [from] =&gt; Array                             (                             )                          )                      [mongo] =&gt; Mongo Object                     (                         [connected] =&gt; 1                         [status] =&gt;                          [server:protected] =&gt; 127.0.0.1:27017                         [persistent:protected] =&gt;                      )                      [db_bible] =&gt; Postgres_Lite Object                     (                         [config:protected] =&gt; Array                             (                                 [benchmark] =&gt; 1                                 [persistent] =&gt;                                  [connection] =&gt; Array                                     (                                         [type] =&gt; pgsql                                         [user] =&gt; dev                                         [pass] =&gt;                                          [host] =&gt; 127.0.0.1                                         [port] =&gt; 5432                                         [socket] =&gt;                                          [database] =&gt; bibletext                                     )                                      [character_set] =&gt; utf8                                 [table_prefix] =&gt;                                  [object] =&gt;                                  [escape] =&gt; 1                             )                              [link:protected] =&gt; Resource id #17                         [set:protected] =&gt; Array                             (                             )                              [where:protected] =&gt; Array                             (                             )                              [last_query:protected] =&gt; SELECT * FROM languages_versions                     )                      [cache_expire_search] =&gt; 1                 [cache_expire_error] =&gt; 1             )              [1] =&gt; valid_reference_and_version     )     , Validation Object     (         [http_code:protected] =&gt; 400         [empty_rules:protected] =&gt; Array             (                 [0] =&gt; required                 [1] =&gt; matches                 [2] =&gt; xor_isset                 [3] =&gt; or_isset                 [4] =&gt; and_isset             )              [pre_filters:protected] =&gt; Array             (                 [*] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [1] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; trim                             )                              [2] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; string_number_to_float_or_int                             )                          )                  )              [post_filters:protected] =&gt; Array             (             )              [rules:protected] =&gt; Array             (                 [auth_user_id] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                              [1] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; numeric                                     )                                      [1] =&gt;                              )                              [2] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; valid                                         [1] =&gt; positive                                     )                                      [1] =&gt;                              )                          )                      [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Array                                     (                                         [0] =&gt; Validation Object      *RECURSION*                                         [1] =&gt; required                                     )                                      [1] =&gt;                              )                          )                  )              [callbacks:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_content                             )                          )                      [reference] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [version] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_reference_and_version                             )                          )                      [user_status] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; Notes_2_3_Model Object                                     (                                         [errors:protected] =&gt; Array                                             (                                             )                                              [db] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; youversiondev                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #4                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                                                  [from] =&gt; Array                                                     (                                                     )                                                  )                                              [mongo] =&gt; Mongo Object                                             (                                                 [connected] =&gt; 1                                                 [status] =&gt;                                                  [server:protected] =&gt; 127.0.0.1:27017                                                 [persistent:protected] =&gt;                                              )                                              [db_bible] =&gt; Postgres_Lite Object                                             (                                                 [config:protected] =&gt; Array                                                     (                                                         [benchmark] =&gt; 1                                                         [persistent] =&gt;                                                          [connection] =&gt; Array                                                             (                                                                 [type] =&gt; pgsql                                                                 [user] =&gt; dev                                                                 [pass] =&gt;                                                                  [host] =&gt; 127.0.0.1                                                                 [port] =&gt; 5432                                                                 [socket] =&gt;                                                                  [database] =&gt; bibletext                                                             )                                                              [character_set] =&gt; utf8                                                         [table_prefix] =&gt;                                                          [object] =&gt;                                                          [escape] =&gt; 1                                                     )                                                      [link:protected] =&gt; Resource id #17                                                 [set:protected] =&gt; Array                                                     (                                                     )                                                      [where:protected] =&gt; Array                                                     (                                                     )                                                      [last_query:protected] =&gt; SELECT * FROM languages_versions                                             )                                              [cache_expire_search] =&gt; 1                                         [cache_expire_error] =&gt; 1                                     )                                      [1] =&gt; valid_user_status                             )                          )                      [highlight_color] =&gt; Array                     (                         [0] =&gt; Array                             (                                 [0] =&gt; valid                                 [1] =&gt; valid_color                             )                          )                  )              [errors:protected] =&gt; Array             (                 [content] =&gt; Array                     (                         [0] =&gt; invalid_xml_definition                         [1] =&gt; document invalid                     )                  )              [messages:protected] =&gt; Array             (             )              [array_fields:protected] =&gt; Array             (             )              [submitted:protected] =&gt; 1         [storage:ArrayObject:private] =&gt; Array             (                 [auth_user_id] =&gt; 4163177                 [title] =&gt; rfesfer                 [content] =&gt; fesfewr                 [language_iso] =&gt;                  [reference] =&gt; Array                     (                         [book] =&gt; gen                         [chapter] =&gt; 1                         [version] =&gt; 1-10                     )                      [version] =&gt; aa                 [created] =&gt;                  [published] =&gt;                  [user_status] =&gt; draft                 [share_connections] =&gt;                  [highlight_color] =&gt;                  [rich_content] =&gt;              )          )     , reference, reference )     /var/www/releases/20111020205231/modules/youversion_api/models/notes_2_3.php [90]:Validation->validate(  )     /var/www/releases/20111020205231/applications/api/controllers/notes_2_1.php [27]:Notes_2_3_Model->create( Array     (         [title] =&gt; rfesfer         [content] =&gt; fesfewr         [language_iso] =&gt;          [reference] =&gt; Array             (                 [book] =&gt; gen                 [chapter] =&gt; 1                 [version] =&gt; 1-10             )              [version] =&gt; aa         [published] =&gt;          [user_status] =&gt;          [shared_connections] =&gt;          [token] =&gt; 615ad51b71049e299842f5af14c70cad         [auth_user_id] =&gt; 4163177         [auth_username] =&gt; testuser     )      )     Notes_2_1_Controller->create(  )     /var/www/releases/20111020205231/system/core/Kohana.php [270]:ReflectionMethod->invokeArgs( Notes_2_3_Controller Object     (         [output:protected] =&gt; json         [user_id:protected] =&gt; 4163177         [username:protected] =&gt; testuser         [password:protected] =&gt; tenders         [uri] =&gt; URI Object             (             )              [input] =&gt; Input Object             (                 [use_xss_clean:protected] =&gt; 1                 [magic_quotes_gpc:protected] =&gt;                  [ip_address] =&gt;              )              [model] =&gt; Notes_2_3_Model Object             (                 [errors:protected] =&gt; Array                     (                     )                      [db] =&gt; Postgres_Lite Object                     (                         [config:protected] =&gt; Array                             (                                 [benchmark] =&gt; 1                                 [persistent] =&gt;                                  [connection] =&gt; Array                                     (                                         [type] =&gt; pgsql                                         [user] =&gt; dev                                         [pass] =&gt;                                          [host] =&gt; 127.0.0.1                                         [port] =&gt; 5432                                         [socket] =&gt;                                          [database] =&gt; youversiondev                                     )                                      [character_set] =&gt; utf8                                 [table_prefix] =&gt;                                  [object] =&gt;                                  [escape] =&gt; 1                             )                              [link:protected] =&gt; Resource id #4                         [set:protected] =&gt; Array                             (                             )                              [where:protected] =&gt; Array                             (                             )                              [last_query:protected] =&gt; SELECT     \t\t\t\t\t\tu.id AS id,     \t\t\t\t\t\tu.username AS username,     \t\t\t\t\t\ttrim(u.first_name || &#039; &#039; || u.last_name) AS name,     \t\t\t\t\t\tu.first_name AS first_name,     \t\t\t\t\t\tu.last_name AS last_name,     \t\t\t\t\t\tu.location,     \t\t\t\t\t\tu.im_type,     \t\t\t\t\t\tu.im_username AS im_value,     \t\t\t\t\t\tu.website,     \t\t\t\t\t\tu.phone_mobile AS mobile,     \t\t\t\t\t\tu.postal_code AS postal_code,     \t\t\t\t\t\tu.language_tag AS language,     \t\t\t\t\t\tu.country,     \t\t\t\t\t\tu.timezone,     \t\t\t\t\t\tu.created_dt AS created,     \t\t\t\t\t\tu.last_login_dt AS last_login,     \t\t\t\t\t\tu.twitter,     \t\t\t\t\t\tu.facebook,     \t\t\t\t\t\temail FROM users u  WHERE u.id = 4163177 AND u.verified IS true                          [from] =&gt; Array                             (                             )                          )                      [mongo] =&gt; Mongo Object                     (                         [connected] =&gt; 1                         [status] =&gt;                          [server:protected] =&gt; 127.0.0.1:27017                         [persistent:protected] =&gt;                      )                      [db_bible] =&gt; Postgres_Lite Object                     (                         [config:protected] =&gt; Array                             (                                 [benchmark] =&gt; 1                                 [persistent] =&gt;                                  [connection] =&gt; Array                                     (                                         [type] =&gt; pgsql                                         [user] =&gt; dev                                         [pass] =&gt;                                          [host] =&gt; 127.0.0.1                                         [port] =&gt; 5432                                         [socket] =&gt;                                          [database] =&gt; bibletext                                     )                                      [character_set] =&gt; utf8                                 [table_prefix] =&gt;                                  [object] =&gt;                                  [escape] =&gt; 1                             )                              [link:protected] =&gt; Resource id #17                         [set:protected] =&gt; Array                             (                             )                              [where:protected] =&gt; Array                             (                             )                              [last_query:protected] =&gt; SELECT * FROM languages_versions                     )                      [cache_expire_search] =&gt; 1                 [cache_expire_error] =&gt; 1             )          )      )     Kohana::instance(  )     /var/www/releases/20111020205231/system/core/Event.php [209]:call_user_func( Array     (         [0] =&gt; Kohana         [1] =&gt; instance     )      )     /var/www/releases/20111020205231/system/core/Bootstrap.php [55]:Event::run( system.execute )     index.php [100]:require( /var/www/releases/20111020205231/system/core/Bootstrap.php )", "buildtime"=>"2011-10-21T17:42:29+00:00"}}}
\ No newline at end of file
diff --git a/lib/yv_api.rb b/lib/yv_api.rb
index b109058..26ce1f3 100644
--- a/lib/yv_api.rb
+++ b/lib/yv_api.rb
@@ -60,6 +60,7 @@ class YvApi
     # Set the base URL
     base = (protocol + "://" + Cfg.api_root + "/" + Cfg.api_version)
     response = httparty_post(base + path, body: opts)
+File.open('/home/caedmon/Desktop/export.txt', 'w') {|f| f.write(response) }
     return api_response_or_rescue(response, block)
   end
 
-- 
1.7.0.4

